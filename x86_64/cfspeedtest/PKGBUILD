pkgname=cfspeedtest
pkgver=2.0.1
pkgrel=2
pkgdesc="Unofficial CLI for speed.cloudflare.com"
arch=('x86_64' 'aarch64')
url="https://github.com/code-inflation/cfspeedtest"
license=('MIT')
depends=('glibc' 'gcc-libs')
provides=("${pkgname}")
conflicts=("${pkgname}")
source=("$url/archive/refs/tags/v${pkgver}.tar.gz")
source_x86_64=("$url/releases/download/v${pkgver}/${pkgname}-x86_64-unknown-linux-gnu.tar.gz")
sha256sums=('SKIP')
sha256sums_x86_64=('SKIP')

package() {
  install -Dm755 "$srcdir/${pkgname}" "$pkgdir/usr/bin/${pkgname}"
  install -Dm644 "$srcdir/${pkgname}-${pkgver}/LICENSE.txt" "$pkgdir/usr/share/licenses/${pkgname}/LICENSE.txt"

  install -dm755 "$pkgdir/usr/share/bash-completion/completions" &&
    "$srcdir/${pkgname}" --generate-completion bash > \
      "$pkgdir/usr/share/bash-completion/completions/cfspeedtest"
  install -dm755 "$pkgdir/usr/share/zsh/site-functions" &&
    "$srcdir/${pkgname}" --generate-completion zsh > \
      "$pkgdir/usr/share/zsh/site-functions/_cfspeedtest"
  install -dm755 "$pkgdir/usr/share/fish/vendor_completions.d" &&
    "$srcdir/${pkgname}" --generate-completion fish > \
      "$pkgdir/usr/share/fish/vendor_completions.d/cfspeedtest.fish"
}
